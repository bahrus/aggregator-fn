<html>
    <body>
        <div>
            <xtal-sip><script nomodule>["xtal-deco", "aggregator-fn", "p-d"]</script></xtal-sip>
            <xtal-deco>
                <script nomodule>
                    ({
                        on:{
                            click: function(e){
                                const agg = e.target.nextElementSibling;
                                agg.a = Math.random() * 10;
                                agg.b = Math.random() * 10;
                                agg.c = Math.random() * 10;
                            }
                        }
                    })
                </script>
            </xtal-deco>
            <button>Click Test</button>
            <aggregator-fn><script nomodule>
                fn = ({a, b, c, __this}) => {
                    console.log(__this);
                    return a + b + c;
                }
            </script></aggregator-fn>
            <p-d on="value-changed" skip-init prop="textContent"></p-d>
            <div></div>
            <aggregator-fn>
                <script nomodule>
                    ({a, b, c}) => {
                        const x = a^2;
                        const y = b^2;
                        const z = c^2;
                        return x + y + z;
                    }
                </script>
            </aggregator-fn>

            <!-- Use experimental import maps -->
            <script defer src="https://unpkg.com/es-module-shims@0.2.7/dist/es-module-shims.js"></script>
            <script type="importmap-shim">
                    {
                        "imports": {
                            "xtal-sip": "https://unpkg.com/xtal-sip@0.0.80/xtal-sip.js",
                            "p-d": "https://unpkg.com/p-d.p-u@0.0.122/p-d.js?module",
                            "xtal-deco": "https://unpkg.com/xtal-decorator@0.0.45/xtal-deco.js?module",
                            "xtal-element/": "../node_modules/xtal-element/",
                            "trans-render/": "../node_modules/trans-render/",
                            "aggregator-fn": "../aggregator-fn.js"
                        }
                    }
                    </script>
            <script  type="module-shim">
                import 'xtal-sip';
            </script>
        </div>
    </body>
</html>