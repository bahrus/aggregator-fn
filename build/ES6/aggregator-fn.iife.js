(function(){const debounce=(fn,time)=>{let timeout;return function(){clearTimeout(timeout);timeout=setTimeout(()=>fn.apply(this,arguments),time)}};function getScript(srcScript){const inner=srcScript.innerHTML.trim();if(inner.startsWith("(")){const ied=self.xtal_latx_ied;if(ied!==void 0){return ied(inner)}else{const iFatArrowPos=inner.indexOf("=>");let lhs=inner.substr(0,iFatArrowPos);["(",")","{","}"].forEach(t=>lhs=lhs.replace(t,""));const rhs=inner.substr(iFatArrowPos+2);return{args:lhs.split(",").map(s=>s.trim()),body:rhs}}}else{return null}}function destruct(target,prop,megaProp="input"){let debouncers=target._debouncers;if(!debouncers)debouncers=target._debouncers={};let debouncer=debouncers[megaProp];if(!debouncer){debouncer=debouncers[megaProp]=debounce(()=>{target[megaProp]=Object.assign({},target[megaProp])},10)}Object.defineProperty(target,prop,{get:function(){return this["_"+prop]},set:function(val){this["_"+prop]=val;if(this[megaProp]){this[megaProp][prop]=val;debouncer()}else{this[megaProp]={[prop]:val}}},enumerable:!0,configurable:!0})}const disabled="disabled";function XtallatX(superClass){return class extends superClass{constructor(){super(...arguments);this._evCount={}}static get observedAttributes(){return[disabled]}get disabled(){return this._disabled}set disabled(val){this.attr(disabled,val,"")}attr(name,val,trueVal){const v=val?"set":"remove";this[v+"Attribute"](name,trueVal||val)}to$(n){const mod=n%2;return(n-mod)/2+"-"+mod}incAttr(name){const ec=this._evCount;if(name in ec){ec[name]++}else{ec[name]=0}this.attr("data-"+name,this.to$(ec[name]))}attributeChangedCallback(name,oldVal,newVal){switch(name){case disabled:this._disabled=null!==newVal;break;}}de(name,detail,asIs){const eventName=name+(asIs?"":"-changed"),newEvent=new CustomEvent(eventName,{detail:detail,bubbles:!0,composed:!1});this.dispatchEvent(newEvent);this.incAttr(eventName);return newEvent}_upgradeProperties(props){props.forEach(prop=>{if(this.hasOwnProperty(prop)){let value=this[prop];delete this[prop];this[prop]=value}})}}}const input="input";class AggregatorFn extends XtallatX(HTMLElement){constructor(){super(...arguments);this._aggregator=null}static get is(){return"aggregator-fn"}static get observedAttributes(){return super.observedAttributes.concat([input])}get input(){return this._input}set input(val){this._input=val;this.aggregate()}get value(){return this._value}set value(val){this._value=val;this.de("value",{value:val})}get aggregator(){return this._aggregator}set aggregator(val){this._aggregator=val;this.aggregate()}aggregate(){if(this._input===void 0||this._aggregator===void 0||null===this._aggregator||this._disabled)return;this.value=this._aggregator(this._input)}attributeChangedCallback(name,oldVal,newVal){switch(name){case input:this.input=JSON.parse(newVal);break;}super.attributeChangedCallback(name,oldVal,newVal);this.aggregate()}connectedCallback(){this.style.display="none";this._upgradeProperties(["disabled",input]);this.getS()}getS(){this._script=this.querySelector("script");if(!this._script){setTimeout(()=>{this.getS()},10);return}this.eval()}eval(){const sInf=getScript(this._script);if(null===sInf)return;sInf.args.forEach(arg=>{destruct(this,arg)});const inner=this._script.innerHTML;console.log(inner);attachScriptFn(AggregatorFn.is,this,"aggregator",`
const __fn = ${inner};
`)}}AggregatorFn._count=0;(function(custEl){let tagName=custEl.is;if(customElements.get(tagName)){console.warn("Already registered "+tagName);return}customElements.define(tagName,custEl)})(AggregatorFn)})();